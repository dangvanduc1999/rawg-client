{"version":3,"sources":["utils/apiCaller.js","constants/KeyConstants.js","actions/GamesActions.js","actions/GameActions.js","selectors/GameSelectors.js","containers/GameContainer.js"],"names":["camelize","require","instanceNext","axios","create","baseURL","API_URL","timeout","fetchApi","endpoint","a","method","body","params","sourceToken","url","data","cancelToken","interceptors","request","use","config","newUrl","PUBLIC_API_KEY","includes","replace","Promise","resolve","error","reject","response","message","GENRE_COLLECTION_TYPE","SEARCH_COLLECTION_TYPE","TAG_COLLECTION_TYPE","GAME_COLLECTION_TYPE","gamesFetchRequest","collectionKey","type","FETCH_GAMES_REQUEST","payload","gamesFetchSuccess","fetchedData","nextUrl","FETCH_GAMES_SUCCESS","fetchGames","dispatch","next","results","console","log","fetchGamesNext","gamesNextUrl","getState","state","games","getGames","collection","isFetching","isExist","loading","fetchGamesIfNeeded","isExists","hasItems","length","fetchGameScreenshotsSuccess","screenshots","FETCH_GAME_SCREENSHOTS_SUCCESS","fetchGameScreenshots","id","GAME_PATH","fetchGame","getCollectionKey","createSelector","getSlug","slug","join","getGame","key","getScreenshots","connect","game","isAuthenticated","getIsAuthenticated","likes","getLikes","fetchGameIfNeeded","playFullVideo","changeRoute","toggleLike","Game"],"mappings":"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","file":"static/js/4.9756f7d7.chunk.js","sourcesContent":["import axios from 'axios';\nimport { API_URL, PUBLIC_API_KEY } from '../constants/urlApi';\nconst camelize = require('camelize');\n\nconst instanceNext = axios.create({\n  baseURL: API_URL,\n  timeout: 10000\n});\n\ninstanceNext.interceptors.request.use(\n  config => {\n    let newUrl = `${config.url}&key=${PUBLIC_API_KEY}`;\n    if (!config.url.includes('?')) {\n      newUrl = newUrl.replace('&', '?');\n    }\n    config.url = newUrl;\n    return Promise.resolve(config);\n  },\n  error => Promise.reject(error)\n);\n\ninstanceNext.interceptors.response.use(\n  response => camelize(response.data),\n  error => {\n    if (error.response) {\n      return Promise.reject(error.response);\n    }\n    if (error.request) {\n      return Promise.reject(error.request);\n    }\n    return Promise.reject(error.message);\n  }\n);\n\nexport async function fetchApi(\n  endpoint,\n  method = 'GET',\n  body,\n  params,\n  sourceToken\n) {\n  return instanceNext({\n    method: method,\n    url: endpoint,\n    data: body,\n    params: params,\n    cancelToken: sourceToken\n  });\n}\n\nexport async function fetchAllApi(requests = []) {\n  return axios.all(requests);\n}\n","export const GENRE_COLLECTION_TYPE = 'GENRE_COLLECTION_TYPE';\nexport const SEARCH_COLLECTION_TYPE = 'GENRE_COLLECTION_TYPE';\nexport const TAG_COLLECTION_TYPE = 'TAG_COLLECTION_TYPE';\n\nexport const GAME_COLLECTION_TYPE = 'GAME_COLLECTION_TYPE';\n","import {\n  FETCH_GAMES_REQUEST,\n  FETCH_GAMES_SUCCESS\n} from '../constants/ActionTypes';\nimport { fetchApi } from '../utils/apiCaller';\nimport { getGames } from '../selectors/CommonSelectors';\n\nexport const gamesFetchRequest = collectionKey => ({\n  type: FETCH_GAMES_REQUEST,\n  payload: { collectionKey }\n});\n\nexport const gamesFetchSuccess = (collectionKey, fetchedData, nextUrl) => ({\n  type: FETCH_GAMES_SUCCESS,\n  payload: { collectionKey, fetchedData, nextUrl }\n});\n\nexport const fetchGames = (collectionKey, url, method) => async dispatch => {\n  try {\n    dispatch(gamesFetchRequest(collectionKey));\n    const data = await fetchApi(url, method);\n\n    const { next, results } = data;\n\n    dispatch(gamesFetchSuccess(collectionKey, results, next));\n  } catch (err) {\n    console.log('fetchGames error', err);\n  }\n};\n\nexport const fetchGamesNext = (collectionKey, gamesNextUrl) => async (\n  dispatch,\n  getState\n) => {\n  const state = getState();\n  const games = getGames(state);\n  const collection = games[collectionKey];\n  const isExist = !!collection;\n  const isFetching = isExist ? collection.loading : false;\n  const shouldFetch = isExist && !isFetching && gamesNextUrl;\n  if (shouldFetch) {\n    dispatch(fetchGames(collectionKey, gamesNextUrl));\n  }\n};\n\nexport const fetchGamesIfNeeded = (collectionKey, url) => async (\n  dispatch,\n  getState\n) => {\n  const state = getState();\n  const games = getGames(state);\n  const collection = games[collectionKey];\n  const isExists = !!collection;\n  const isFetching = isExists ? collection.loading : false;\n  const hasItems = isExists ? collection.games.length > 0 : false;\n  if (!isExists || (!hasItems && !isFetching)) {\n    dispatch(fetchGames(collectionKey, url));\n  }\n};\n","import { FETCH_GAME_SCREENSHOTS_SUCCESS } from '../constants/ActionTypes';\nimport { gamesFetchSuccess } from '../actions/GamesActions';\nimport { getGames } from '../selectors/CommonSelectors';\nimport { GAME_PATH } from '../constants/urlApi';\nimport { fetchApi } from '../utils/apiCaller';\n\nconst fetchGameScreenshotsSuccess = (collectionKey, screenshots) => ({\n  type: FETCH_GAME_SCREENSHOTS_SUCCESS,\n  payload: { collectionKey, screenshots }\n});\n\nconst fetchGameScreenshots = (id, collectionKey) => async dispatch => {\n  const url = `${GAME_PATH.replace(':slug', id)}/screenshots?page_size=20`;\n  const data = await fetchApi(url);\n  const { results } = data;\n  dispatch(fetchGameScreenshotsSuccess(collectionKey, results));\n};\n\nconst fetchGame = (collectionKey, url) => async dispatch => {\n  const data = await fetchApi(url);\n  const { id } = data;\n  if (id) {\n    dispatch(gamesFetchSuccess(collectionKey, [data], null));\n    dispatch(fetchGameScreenshots(id, collectionKey));\n  }\n};\n\nexport const fetchGameIfNeeded = (slug, collectionKey) => async (\n  dispatch,\n  getState\n) => {\n  const state = getState();\n  const games = getGames(state);\n  const collection = games[collectionKey];\n  const isExists = !!collection;\n  const hasItems = isExists ? collection.games.length > 0 : false;\n  if (!isExists || !hasItems) {\n    const url = GAME_PATH.replace(':slug', slug);\n    dispatch(fetchGame(collectionKey, url));\n  }\n};\n","import { createSelector } from 'reselect';\nimport { getSlug, getGames } from './CommonSelectors';\nimport { GAME_COLLECTION_TYPE } from '../constants/KeyConstants';\n\nexport const getCollectionKey = createSelector(getSlug, slug =>\n  [GAME_COLLECTION_TYPE, slug].join('|')\n);\n\nexport const getGame = createSelector(\n  getGames,\n  getCollectionKey,\n  (games, key) => {\n    const collection = games[key];\n    return collection && collection.games.length > 0\n      ? collection.games[0]\n      : null;\n  }\n);\n\nexport const getScreenshots = createSelector(\n  [getGames, getCollectionKey],\n  (games, key) => {\n    const collection = games[key];\n    return collection && collection.screenshots ? collection.screenshots : [];\n  }\n);\n","import { connect } from 'react-redux';\nimport { Game } from '../components';\nimport { fetchGameIfNeeded } from '../actions/GameActions';\nimport { playFullVideo } from '../actions/AppActions';\nimport { changeRoute } from '../actions/RouterActions';\nimport { toggleLike } from '../actions/UserActions';\nimport {\n  getGame,\n  getCollectionKey,\n  getScreenshots\n} from '../selectors/GameSelectors';\nimport {\n  getSlug,\n  getIsAuthenticated,\n  getLikes\n} from '../selectors/CommonSelectors';\n\nconst mapStateToProps = state => {\n  return {\n    game: getGame(state),\n    collectionKey: getCollectionKey(state),\n    slug: getSlug(state),\n    screenshots: getScreenshots(state),\n    isAuthenticated: getIsAuthenticated(state),\n    likes: getLikes(state)\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchGameIfNeeded,\n  playFullVideo,\n  changeRoute,\n  toggleLike\n})(Game);\n"],"sourceRoot":""}